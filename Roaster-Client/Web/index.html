<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>

    <p>Hold temperature</p>
    <input type="text" id="holdTemperature" type="number" value="100" />
    
    <button id="holdOn">Hold On</button>
    <button id="holdOff">Hold Off</button>

    <pre id="roasterStatus"></pre>

    <script src="Scripts/jquery-2.2.4.min.js"></script>
    <script type="text/javascript">
        var ip = location.host.substring(0, location.host.indexOf(":"))
        var apiHost = "http://" + ip + ":9900/";
        $("#holdOff").hide();

        $("#holdOn").click(function () {
            var holdTemperature = $("#holdTemperature").val();

            $.get(apiHost + "api/Roaster/HoldTemperature/On/" + holdTemperature);
        });

        $("#holdOff").click(function () {
            var holdTemperature = $("holdTemperature").val();

            $.get(apiHost + "api/Roaster/HoldTemperature/Off");
        });

        
        var prevHoldTemperature = 100;
        window.setInterval(function () {
            $.get(apiHost + 'api/Roaster/Status/Get', function (data) {
                $("#roasterStatus").text(JSON.stringify(data, null, 2));

                // Update view with data from server
                if (prevHoldTemperature != data.CurrentHoldTemperature) {
                    $("#holdTemperature").val(data.CurrentHoldTemperature);
                    prevHoldTemperature = data.CurrentHoldTemperature;
                }
                
                if (data.IsHoldOn)
                {
                    $("#holdOn").hide();
                    $("#holdOff").show();
                }
                else
                {
                    $("#holdOn").show();
                    $("#holdOff").hide();
                }
            });
        }, 1000);
    </script>
</body>
</html>